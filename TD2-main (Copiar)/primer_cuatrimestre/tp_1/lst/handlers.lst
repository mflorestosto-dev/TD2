ARM GAS  src/handlers.s 			page 1


   1              	/*
   2              	Este archivo define los manejadores de excepciones (handlers). 
   3              	Cada sección (b .) significa que cuando ocurre esa excepción, el procesador 
   4              	se queda en un bucle infinito (esperando que el usuario lo depure).
   5              	 */
   6              	
   7              	
   8              	.global handler_UND
   9              	.global handler_SWI
  10              	.global handler_prefetch_abort
  11              	.global handler_data_abort
  12              	.global handler_reserved
  13              	.global handler_IRQ
  14              	.global handler_FIQ
  15              	
  16              	.extern kernel_handler_irq
  17              	
  18              	.section .handlers, "ax"
  19              	
  20              	handler_UND:       
  21 0000 FEFFFFEA 	    b .
  22              	
  23              	handler_SWI:         
  24 0004 FEFFFFEA 	    b .
  25              	
  26              	handler_prefetch_abort:      
  27 0008 FEFFFFEA 	    b .
  28              	
  29              	handler_data_abort:          
  30 000c FEFFFFEA 	    b .
  31              	
  32              	handler_reserved:    
  33 0010 FEFFFFEA 	    b .
  34              	
  35              	handler_IRQ:         
  36              	
  37              	    //Entra la excepcion, se guardan Link register,los registros del momento en donde se esta, el S
  38 0014 04E04EE2 	    SUB LR, LR, #4
  39 0018 FF5F2DE9 	    PUSH {R0-R12, LR}
  40 001c 0D70A0E1 	    MOV R7, SP
  41 0020 00804FE1 	    MRS R8, SPSR
  42 0024 80012DE9 	    PUSH {R7, R8}
  43              	
  44              	    // Manejo de excepcion
  45 0028 0D00A0E1 	    MOV R0, SP
  46 002c FEFFFFEB 	    BL kernel_handler_irq
  47              	
  48              	    //Se vuelve todo como estaba antes, se recontruye la pila
  49 0030 8001BDE8 	    POP {R7,R8}
  50 0034 00804FE1 	    MRS R8, SPSR
  51 0038 07D0A0E1 	    MOV SP, R7
  52 003c FF9FFDE8 	    LDMFD sp!, {R0-R12, PC}^
  53              	
  54              	handler_FIQ:         
  55 0040 FEFFFFEA 	    b .
  56              	
  57              	.end...
ARM GAS  src/handlers.s 			page 2


ARM GAS  src/handlers.s 			page 3


DEFINED SYMBOLS
      src/handlers.s:20     .handlers:00000000 handler_UND
      src/handlers.s:23     .handlers:00000004 handler_SWI
      src/handlers.s:26     .handlers:00000008 handler_prefetch_abort
      src/handlers.s:29     .handlers:0000000c handler_data_abort
      src/handlers.s:32     .handlers:00000010 handler_reserved
      src/handlers.s:35     .handlers:00000014 handler_IRQ
      src/handlers.s:54     .handlers:00000040 handler_FIQ
      src/handlers.s:21     .handlers:00000000 $a

UNDEFINED SYMBOLS
kernel_handler_irq
